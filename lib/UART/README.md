# Модуль uart

## Краткое описание модуля

Модуль UART предоставляет функции для работы с универсальным асинхронным приемо-передатчиком. Он позволяет инициализировать UART, отправлять данные, настраивать скорость передачи, биты данных, биты четности и стоп-биты, а также обрабатывать прерывания.

## Краткий перечень доступных функций и структур

- `void USART_init(USART *usart, uint32_t *system_clock, USART_TypeDef *base)` - инициализация UART.
- `void USART_write(USART *usart, uint8_t *data, uint16_t size)` - отправка данных через UART.
- `void USART_begin(USART *usart, uint32_t baud_rate, uint32_t data_bits, enum parity_t parity, uint32_t stop_bits)` - настройка параметров UART.
- `void USART_IRQHandler(USART *usart)` - обработчик прерывания UART.

## Описание функций и структур

- Структура `USART` содержит поля для хранения базового адреса регистров UART, системной частоты, массивов для приема и передачи данных, а также кольцевых буферов для приема и передачи.
- Функция `USART_init` инициализирует UART, устанавливая базовый адрес и системную частоту, а также инициализирует кольцевые буферы для приема и передачи данных.
- Функция `USART_write` отправляет данные через UART. Она проверяет наличие свободного места в буфере передачи и постепенно передает данные, пока не будут отправлены все байты.
- Функция `USART_begin` настраивает параметры UART, включая скорость передачи, биты данных, биты четности и стоп-биты. Она также настраивает соответствующие регистры GPIO для использования UART1.
- Функция `USART_IRQHandler` является обработчиком прерывания UART. Она проверяет состояние флагов прерываний и выполняет соответствующие действия, например, считывает принятый байт или передает следующий байт из буфера передачи.

## Пример использования модуля

```c
#include "uart.h"

USART uart;

int main()
{
   SystemInit();
   SystemCoreClockUpdate();
   SysTick_Config(SystemCoreClock / 1000);

   USART_init(&uart, &SystemCoreClock, USART1); // Инициализация UART
   USART_begin(&uart, 115200, 8, NO, 1); // Настройка параметров UART: скорость 9600 бит/с, 8 бит данных, без четности, 1 стоп-бит

   uint8_t data[] = "Hello, World!"; // Отправка данных через UART
   USART_write(&usart, data, sizeof(data) - 1); // -1 для исключения символа '\0'

   while (1)
   {
      // Ожидание других действий
   }

   return 0;
}
```

В этом примере модуль UART инициализируется с использованием базового адреса USART1 и системной частоты 16 МГц. Параметры UART устанавливаются на скорость 9600 бит/с, 8 бит данных, без четности и 1 стоп-бита. Затем отправляется строка "Hello, World!" через UART.
